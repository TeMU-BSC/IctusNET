<form [formGroup]="form">
  <p>STATIC PROTOTYPE</p>

  <div fxLayout fxLayoutAlign="space-between" class="collapse-expand-buttons">
    <button mat-button type="button" color="secondary" (click)="accordion.closeAll()">
      <mat-icon style="padding: 0;">unfold_less</mat-icon>Colapsar todo
    </button>
    <button mat-button type="button" color="secondary" (click)="accordion.openAll()">
      <mat-icon style="padding: 0;">unfold_more</mat-icon>Expandir todo
    </button>
  </div>

  <mat-accordion class="example-headers-align" multi>

    <mat-expansion-panel [expanded]="step === 0" (opened)="setStep(0)">
      <mat-expansion-panel-header>
        <mat-panel-title>
          <mat-icon>airport_shuttle</mat-icon>
          <span class="title">Entrada y salida del paciente</span>
        </mat-panel-title>
      </mat-expansion-panel-header>

      <!-- <formly-form [form]="form" [model]="model" [fields]="fields" [options]="options"></formly-form> -->

      <p>Inicio de los síntomas</p>
      <mat-form-field appearance="outline">
        <mat-label>Fecha</mat-label>
        <input matInput type="date" formControlName="fechaInicioSintomas">
        <mat-icon matSuffix color="primary" matTooltip="También es válida la última vez que el paciente estuvo asintomático."
          matTooltipPosition="right">info</mat-icon>
      </mat-form-field>
      <mat-form-field appearance="outline" class="short-field">
        <mat-label>Hora</mat-label>
        <input matInput type="time" formControlName="horaInicioSintomas">
      </mat-form-field>

      <p>Llegada al hospital</p>
      <mat-form-field appearance="outline">
        <mat-label>Fecha</mat-label>
        <input matInput type="date" formControlName="fechaLlegadaHospital">
      </mat-form-field>
      <mat-form-field appearance="outline" class="short-field">
        <mat-label>Hora</mat-label>
        <input matInput type="time" formControlName="horaLlegadaHospital">
      </mat-form-field>

      <p>Ingreso</p>
      <mat-form-field appearance="outline">
        <mat-label>Fecha</mat-label>
        <input matInput #input type="date" formControlName="fechaIngreso">
      </mat-form-field>

      <p>Alta</p>
      <mat-form-field appearance="outline">
        <mat-label>Fecha</mat-label>
        <input matInput type="date" formControlName="fechaAlta">
      </mat-form-field>
      <mat-form-field appearance="outline" class="short-field">
        <mat-label>Hora</mat-label>
        <input matInput type="time" formControlName="horaAlta">
      </mat-form-field>

      <mat-action-row>
        <button mat-button color="primary" (click)="nextStep()">Siguiente</button>
      </mat-action-row>
    </mat-expansion-panel>

    <mat-expansion-panel [expanded]="step === 1" (opened)="setStep(1)">
      <mat-expansion-panel-header>
        <mat-panel-title>
          <mat-icon>local_hospital</mat-icon>
          <span class="title">Diagnóstico</span>
        </mat-panel-title>
      </mat-expansion-panel-header>

      <div fxLayout="column">
        <mat-form-field appearance="outline">
          <mat-label>Diagnóstico principal</mat-label>
          <mat-select formControlName="diagnosticoPrincipal">
            <mat-option *ngFor="let option of options.diagnosticoPrincipal" [value]="option.value">
              {{ option.value }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Arterias afectadas</mat-label>
          <mat-select multiple formControlName="arteriasAfectadas">
            <mat-option *ngFor="let option of options.arteriasAfectadas" [value]="option.value">
              {{ option.value }}
            </mat-option>
          </mat-select>
          <mat-icon matSuffix color="primary"
            matTooltip='Para diagnóstico principal "ictus isquémico". Acepta múltiples valores.'
            matTooltipPosition="right">info
          </mat-icon>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Localizaciones</mat-label>
          <mat-select multiple formControlName="localizaciones">
            <mat-option *ngFor="let option of options.localizaciones" [value]="option.value">
              {{ option.value }}
            </mat-option>
          </mat-select>
          <mat-icon matSuffix color="primary" matTooltip="Acepta múltiples valores." matTooltipPosition="right">info
          </mat-icon>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Lateralización</mat-label>
          <mat-select formControlName="lateralizacion">
            <mat-option *ngFor="let option of options.lateralizacion" [value]="option.value">
              {{ option.value }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Etiología</mat-label>
          <mat-select formControlName="etiologia">
            <mat-option *ngFor="let option of getEtiologiaOptions()" [value]="option.value">
              {{ option.value }}
            </mat-option>
          </mat-select>
          <mat-icon matSuffix color="primary" matTooltip='Las opciones varían según el diagnóstico principal.'
            matTooltipPosition="right">info
          </mat-icon>
        </mat-form-field>
      </div>

      <mat-action-row>
        <button mat-button color="secondary" (click)="prevStep()">Anterior</button>
        <button mat-button color="primary" (click)="nextStep()">Siguiente</button>
      </mat-action-row>
    </mat-expansion-panel>

    <mat-expansion-panel [expanded]="step === 2" (opened)="setStep(2)">
      <mat-expansion-panel-header>
        <mat-panel-title>
          <mat-icon>healing</mat-icon>
          <span class="title">Procedimientos y pruebas</span>
        </mat-panel-title>
      </mat-expansion-panel-header>

      <p>Trombólisis intravenosa</p>
      <mat-form-field appearance="outline">
        <mat-label>Fecha</mat-label>
        <input matInput type="date">
      </mat-form-field>
      <mat-form-field appearance="outline" class="short-field">
        <mat-label>Hora</mat-label>
        <input matInput PrimerBolusTrombolisisRtpa type="time">
        <mat-icon matSuffix color="primary" matTooltip='Hora del primer bolus de la trombólisis rtPA'
          matTooltipPosition="right">info
        </mat-icon>
      </mat-form-field>

      <p>Trombólisis intraaerterial</p>
      <mat-form-field appearance="outline">
        <mat-label>Fecha</mat-label>
        <input matInput type="date">
      </mat-form-field>
      <mat-form-field appearance="outline" class="short-field">
        <mat-label>Hora</mat-label>
        <input matInput type="time">
      </mat-form-field>

      <p>Inicio de la trombectomía mecánica</p>
      <mat-form-field appearance="outline">
        <mat-label>Fecha</mat-label>
        <input matInput type="date">
      </mat-form-field>
      <mat-form-field appearance="outline" class="short-field">
        <mat-label>Hora</mat-label>
        <input matInput type="time">
        <mat-icon matSuffix color="primary" matTooltip='Hora de la punción arterial (groin puncture)'
          matTooltipPosition="right">info
        </mat-icon>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Regla tiempo punción (¿núm. entero?)</mat-label>
        <input matInput #tiempoPuertaPuncion type="number">
      </mat-form-field>

      <p>Primera serie de la trombectomía mecánica</p>
      <mat-form-field appearance="outline">
        <mat-label>Fecha</mat-label>
        <input matInput type="date">
      </mat-form-field>
      <mat-form-field appearance="outline" class="short-field">
        <mat-label>Hora</mat-label>
        <input matInput type="time">
      </mat-form-field>

      <p>Recanalización para la trombectomía mecánica</p>
      <mat-form-field appearance="outline">
        <mat-label>Fecha</mat-label>
        <input matInput type="date">
      </mat-form-field>
      <mat-form-field appearance="outline" class="short-field">
        <mat-label>Hora</mat-label>
        <input matInput type="time">
      </mat-form-field>

      <p>Fin de la trombectomía mecánica</p>
      <mat-form-field appearance="outline">
        <mat-label>Fecha</mat-label>
        <input matInput type="date">
      </mat-form-field>
      <mat-form-field appearance="outline" class="short-field">
        <mat-label>Hora</mat-label>
        <input matInput type="time">
      </mat-form-field>

      <p>TAC craneal</p>
      <mat-form-field appearance="outline">
        <mat-label>Fecha</mat-label>
        <input matInput type="date">
      </mat-form-field>
      <mat-form-field appearance="outline" class="short-field">
        <mat-label>Hora</mat-label>
        <input matInput type="time">
      </mat-form-field>

      <mat-action-row>
        <button mat-button color="secondary" (click)="prevStep()">Anterior</button>
        <button mat-button color="primary" (click)="nextStep()">Siguiente</button>
      </mat-action-row>
    </mat-expansion-panel>

    <mat-expansion-panel [expanded]="step === 3" (opened)="setStep(3)">
      <mat-expansion-panel-header>
        <mat-panel-title>
          <mat-icon>analytics</mat-icon>
          <span class="title">Tratamientos y escalas de valoración</span>
        </mat-panel-title>
      </mat-expansion-panel-header>

      <p>ASPECTS</p>
      <mat-form-field appearance="outline" class="short-field">
        <mat-label>ASPECTS</mat-label>
        <input matInput #aspects type="number">
      </mat-form-field>
      <mat-icon matSuffix color="primary" matTooltip="Depende del TAC craneal." matTooltipPosition="right">info
      </mat-icon>

      <p>Tratamiento antiagregante</p>
      <mat-form-field appearance="outline">
        <mat-label>Habitual</mat-label>
        <mat-select multiple>
          <mat-option value="clopidogrel">clopidogrel (plavix)</mat-option>
          <mat-option value="ticlopidine">ticlopidine (tiklid)</mat-option>
          <mat-option value="acetylsalicylic acid, combinations with proton pump inhibitors">
            acetylsalicylic acid, combinations with proton pump inhibitors
          </mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Al alta</mat-label>
        <mat-select multiple>
          <mat-option value="clopidogrel">clopidogrel (plavix)</mat-option>
          <mat-option value="ticlopidine">ticlopidine (tiklid)</mat-option>
          <mat-option value="acetylsalicylic acid, combinations with proton pump inhibitors">
            acetylsalicylic acid, combinations with proton pump inhibitors
          </mat-option>
        </mat-select>
      </mat-form-field>
      <mat-icon matSuffix color="primary" matTooltip="Acepta múltiples valores." matTooltipPosition="right">info
      </mat-icon>

      <p>Tratamiento anticoagulante</p>
      <mat-form-field appearance="outline">
        <mat-label>Habitual</mat-label>
        <mat-select multiple>
          <mat-option value="acenocumarol">acenocumarol (sintrom)</mat-option>
          <mat-option value="warfarin">warfarin (aldocumar)</mat-option>
          <mat-option value="parnaparin">parnaparin</mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Al alta</mat-label>
        <mat-select multiple>
          <mat-option value="acenocumarol">acenocumarol (sintrom)</mat-option>
          <mat-option value="warfarin">warfarin (aldocumar)</mat-option>
          <mat-option value="parnaparin">parnaparin</mat-option>
        </mat-select>
      </mat-form-field>
      <mat-icon matSuffix color="primary" matTooltip="Acepta múltiples valores." matTooltipPosition="right">info
      </mat-icon>

      <p>mRankin</p>
      <mat-form-field appearance="outline" class="short-field">
        <mat-label>Previa</mat-label>
        <input matInput type="number">
      </mat-form-field>
      <mat-form-field appearance="outline" class="short-field">
        <mat-label>Al alta</mat-label>
        <input matInput type="number">
      </mat-form-field>

      <p>NIHSS</p>
      <mat-form-field appearance="outline" class="short-field">
        <mat-label>Previa</mat-label>
        <input matInput type="number">
      </mat-form-field>
      <mat-form-field appearance="outline" class="short-field">
        <mat-label>Al alta</mat-label>
        <input matInput type="number">
      </mat-form-field>

      <mat-action-row>
        <button mat-button color="secondary" (click)="prevStep()">Anterior</button>
        <button mat-button color="primary" (click)="finish()">Finalizar</button>
      </mat-action-row>
    </mat-expansion-panel>

  </mat-accordion>

  <div fxLayout="column" fxLayoutAlign="stretch center" fxLayoutGap="1rem" style="margin-top: 3rem;">
    <button type="submit" mat-raised-button color="primary" #downloadButton (click)="download()">
      Descargar respuestas
    </button>
    <button type="button" mat-button color="secondary" (click)="confirm()">
      Restablecer formulario a los valores iniciales
    </button>
  </div>
</form>
